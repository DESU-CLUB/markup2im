Using default image size for dataset yuntian-deng/im2smiles-20k
Default image size: (128, 128)
Using default input field for dataset yuntian-deng/im2smiles-20k
Default input field: smiles
Using default encoder model type for dataset yuntian-deng/im2smiles-20k
Default encoder model type: DeepChem/ChemBERTa-77M-MLM
Using default color mode for dataset yuntian-deng/im2smiles-20k
Default color mode: rgb
Some weights of RobertaModel were not initialized from the model checkpoint at DeepChem/ChemBERTa-77M-MLM and are newly initialized: ['roberta.pooler.dense.bias', 'roberta.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Some weights of RobertaModel were not initialized from the model checkpoint at DeepChem/ChemBERTa-77M-MLM and are newly initialized: ['roberta.pooler.dense.bias', 'roberta.pooler.dense.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.




















































































































































































































































































































Epoch 0: 100%|█| 1121/1121 [10:17<00:00,  1.82it/s, loss=0.00648, lr=0.0001, scheduled sampling="m=0 (0.9
  0%|                                                                           | 0/1121 [00:00<?, ?it/s]



























































































































































































































































































































































































































































































































































































































































Epoch 2: 100%|█| 1121/1121 [10:31<00:00,  1.77it/s, loss=0.00496, lr=9.98e-5, scheduled sampling="m=0 (0.
  0%|                                                                           | 0/1121 [00:00<?, ?it/s]







































































  File "/home/spooky/Documents/Github Projects/markup2im/src/train.py", line 367, in <module>ng="m=0 (0.9
    main(args)
  File "/home/spooky/Documents/Github Projects/markup2im/src/train.py", line 353, in main
    train(train_dataloader, args.save_dir, args.save_model_every, \
  File "/home/spooky/Documents/Github Projects/markup2im/src/train.py", line 207, in train
    noise_pred = image_decoder(noisy_images_t, timesteps, encoder_hidden_states, attention_mask=masks)["sample"]
  File "/home/spooky/Documents/Github Projects/markup2im/markup/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/spooky/Documents/Github Projects/markup2im/markup/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/spooky/Documents/Github Projects/markup2im/markup/lib/python3.10/site-packages/diffusers/models/unet_2d_condition.py", line 250, in forward
    sample = upsample_block(
  File "/home/spooky/Documents/Github Projects/markup2im/markup/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/spooky/Documents/Github Projects/markup2im/markup/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/spooky/Documents/Github Projects/markup2im/markup/lib/python3.10/site-packages/diffusers/models/unet_blocks.py", line 2110, in forward
    hidden_states = resnet(hidden_states, temb)
  File "/home/spooky/Documents/Github Projects/markup2im/markup/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/spooky/Documents/Github Projects/markup2im/markup/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/spooky/Documents/Github Projects/markup2im/markup/lib/python3.10/site-packages/diffusers/models/resnet.py", line 342, in forward
    hidden_states = self.norm1(hidden_states)
  File "/home/spooky/Documents/Github Projects/markup2im/markup/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/spooky/Documents/Github Projects/markup2im/markup/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/spooky/Documents/Github Projects/markup2im/markup/lib/python3.10/site-packages/torch/nn/modules/normalization.py", line 287, in forward
    return F.group_norm(
  File "/home/spooky/Documents/Github Projects/markup2im/markup/lib/python3.10/site-packages/torch/nn/functional.py", line 2588, in group_norm
    return torch.group_norm(input, num_groups, weight, bias, eps, torch.backends.cudnn.enabled)
KeyboardInterrupt